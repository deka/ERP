(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2674"],{"6CuZ":function(e,t,o){"use strict";var n=o("UNV0");o.n(n).a},GLI9:function(e,t,o){"use strict";o("Kw5r").default.directive("noMoreClick",{inserted:function(e,t){e.addEventListener("click",function(t){e.classList.add("is-disabled"),e.disabled=!0,setTimeout(function(){e.disabled=!1,e.classList.remove("is-disabled")},3e3)})}})},UNV0:function(e,t,o){},UPNS:function(e,t,o){"use strict";o.r(t);var n=o("gDS+"),s=o.n(n),r=(o("GLI9"),o("jeq2")),i=o("6HaC"),a=o("eY10"),l=o("/PQ/"),c=o("moiu"),d=o("D61i"),u={name:"AddIncome",components:{MyRepository:o("Hfa/").a,MyEmp:d.a},data:function(){var e=this;return{treedata:[],suboptions:[],regions:[],region:null,props:{value:"id",label:"regionName",children:"regionListVos"},props2:{value:"id",label:"subjectName",children:"subjectFinanceVos"},pickerOptions1:{disabledDate:function(e){return e.getTime()<(new Date).getTime()-864e5}},colseTypes:[],colseTypeparms:{type:3,pagenum:1,pagesize:99999},incomeRepositoryId:"",repositorycontrol:!1,choosedata:[],depts:[],handlePersonId:this.$store.getters.name,stockControl:!1,personalForm:{createPersonId:this.$store.getters.userId,countryId:this.$store.getters.countryId,repositoryId:this.$store.getters.repositoryId,regionId:this.$store.getters.regionId,currency:"1",incomeDate:null,handlePersonId:this.$store.getters.userId,incomeRegionId:this.$store.getters.regionId},personalrules:{handlePersonId:[{required:!0,validator:function(t,o,n){void 0===e.handlePersonId||null===e.handlePersonId||""===e.handlePersonId?n(new Error("请选择经办人")):n()},trigger:"change"}],incomeDate:[{required:!0,message:"请选择收款日期",trigger:"change"}]},list2:[],validRules:{}}},created:function(){this.getdatatime(),this.getTypes(),this.gettree()},beforeCreate:function(){this},methods:{switchtreedata:function(e){for(var t in e)""===e[t].subjectNumber||null===e[t].subjectNumber?this.switchtreedata(e[t].subjectFinanceVos):(e[t].level>3&&this.switchtreedata(e[t].subjectFinanceVos),e[t].subjectName=e[t].subjectNumber+e[t].subjectName)},getarrs:function(){console.log("222",222),console.log("北京市朝阳区爱谁谁"),console.log("this.personalForm",this.personalForm),console.log("this.regions",this.regions);var e=this.findPathByLeafId(this.personalForm.incomeRegionId,this.regions);console.log("needata",e),this.personalForm.incomeregion=e;var t=e[e.length-1];console.log(t),this.region=t},findPathByLeafId:function(e,t,o){void 0===o&&(o=[]);for(var n=0;n<t.length;n++){var s=o.concat();if(s.push(t[n].id),e===t[n].id)return s;if(t[n].regionListVos){var r=this.findPathByLeafId(e,t[n].regionListVos,s);if(r)return r}}},findtreedata:function(e,t){var o=this,n=void 0;return(e||[]).map(function(e){if(e.id===t)n=e;else{var s=o.findtreedata(e.subjectFinanceVos,t);s&&(n=s)}}),n},processchildren:function(e){for(var t in e)0===e[t].subjectFinanceVos.length?delete e[t].subjectFinanceVos:this.processchildren(e[t].subjectFinanceVos);return e},test:function(e,t){console.log(e,t);var o=t[t.length-1],n=this.findtreedata(this.treedata,o);console.log("needata",n),e.subjectName=n.subjectName,e.subjectCode=n.subjectNumber},gettree:function(){var e=this;console.log(123),Object(r.g)().then(function(t){if(200===t.data.ret){var o=t.data.data.content;console.log("newarr",o);e.switchtreedata(o);e.suboptions=e.processchildren(o),e.treedata=t.data.data.content}}),console.log(321)},handlechange4:function(e){console.log(e);var t=e[e.length-1];console.log(t),this.region=t,this.personalForm.incomeregionId=t},tranKTree:function(e){var t=this;if(e&&e.length)return e.map(function(e){return{id:e.id,regionName:e.regionName,regionListVos:t.tranKTree(e.regionListVos)}})},insertEvent:function(e){this.$refs.editable.insertAt({productCode:null},e)},getTypes:function(){var e=this;Object(c.p)().then(function(t){200===t.data.ret&&(e.depts=t.data.data.content)}),Object(l.i)(7).then(function(t){200===t.data.ret&&(e.colseTypes=t.data.data.content.list)}),Object(i.E)().then(function(t){200===t.data.ret?(e.regions=e.tranKTree(t.data.data.content),e.getarrs()):console.log("区域列表出错")})},getdatatime:function(){var e=new Date,t=e.getFullYear(),o=e.getMonth()+1,n=e.getDate();o>=1&&o<=9&&(o="0"+o),n>=0&&n<=9&&(n="0"+n);var s=t+"-"+o+"-"+n;this.personalForm.incomeDate=s},handlechooseRep:function(){if(null===this.region||""===this.region||void 0===this.region)return this.$notify.error({title:"wrong",message:"请先选择区域",offset:100}),!1;this.repositorycontrol=!0},repositoryname:function(e){this.incomeRepositoryId=e.repositoryName,this.personalForm.incomeRepositoryId=e.id},change:function(){this.$forceUpdate()},handlechooseStock:function(){this.stockControl=!0},stockName:function(e){console.log(e),this.personalForm.deptId=e.deptId,this.incomeRepositoryId=e.repositoryName,this.personalForm.incomeRepositoryId=e.repositoryId,this.handlePersonId=e.personName,this.personalForm.handlePersonId=e.id},restAllForm:function(){this.personalForm={createPersonId:this.$store.getters.userId,countryId:this.$store.getters.countryId,repositoryId:this.$store.getters.repositoryId,regionId:this.$store.getters.regionId,currency:"1",handlePersonId:this.$store.getters.userId},this.handlePersonId=null,this.personalForm.handlePersonId=null,this.incomeRepositoryId=null,this.personalForm.incomeRepositoryId=null},handlesave:function(){var e=this,t=this.$refs.editable.getRecords();if(0===t.length)return this.$notify.error({title:"wrong",message:this.$t("prompt.mxbbnwk"),offset:100}),!1;var o=1;if(t.map(function(e){return e}).forEach(function(e){return null!==e.subjectCode&&""!==e.subjectCode&&void 0!==e.subjectCode||(o=2),null!==e.summary&&""!==e.summary&&void 0!==e.summary||delete e.summary,null!==e.subjectFinanceId&&""!==e.subjectFinanceId&&void 0!==e.subjectFinanceId||delete e.subjectFinanceId,null!==e.money&&""!==e.money&&void 0!==e.money||delete e.money,e}),2===o)return this.$notify.error({title:"wrong",message:"科目名称必选",offset:100}),!1;var n=s()(t),r=this.personalForm;for(var i in r)""!==r[i]&&void 0!==r[i]&&null!==r[i]||delete r[i];var l=s()(r);this.$refs.personalForm.validate(function(t){if(!t)return e.$notify.error({title:"wrong",message:"Information is incomplete",offset:100}),!1;e.$refs.editable.validate().then(function(t){Object(a.a)(l,n,e.personalForm).then(function(t){console.log(t),200===t.data.ret?(e.$notify({title:"successful",message:"save successful",type:"success",offset:100}),e.restAllForm(),e.$refs.editable.clear(),e.$refs.personalForm.clearValidate(),e.$refs.personalForm.resetFields()):e.$notify.error({title:"wrong",message:t.data.msg,offset:100})})}).catch(function(e){console.log("error submit!!")})})},handlecancel:function(){this.$router.go(-1);this.$store.dispatch("delView",{path:"/income/Addincome",name:"Addincome",fullPath:"/income/Addincome",title:"Addincome"}).then(function(e){e.visitedViews})}}},m=(o("6CuZ"),o("KHd+")),p=Object(m.a)(u,function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ERP-container"},[o("div",{staticClass:"app-container",staticStyle:{"padding-right":"0"}},[o("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[o("h2",{ref:"geren",staticClass:"form-name"},[e._v(e._s(e.$t("Hmodule.basicinfo")))]),e._v(" "),o("div",{staticClass:"container",staticStyle:{"margin-top":"37px"}},[o("el-form",{ref:"personalForm",staticClass:"demo-ruleForm",attrs:{model:e.personalForm,rules:e.personalrules,inline:!0,"status-icon":"","label-width":"130px"}},[o("el-row",[o("el-col",{attrs:{span:6}},[o("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("income.title")}},[o("el-input",{staticStyle:{"margin-left":"18px",width:"200px"},attrs:{clearable:""},model:{value:e.personalForm.title,callback:function(t){e.$set(e.personalForm,"title",t)},expression:"personalForm.title"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:6}},[o("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("income.incomeDate"),prop:"incomeDate"}},[o("el-date-picker",{staticStyle:{"margin-left":"18px",width:"200px"},attrs:{"picker-options":e.pickerOptions1,type:"date","value-format":"yyyy-MM-dd"},model:{value:e.personalForm.incomeDate,callback:function(t){e.$set(e.personalForm,"incomeDate",t)},expression:"personalForm.incomeDate"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:6}},[o("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("income.handlePersonId"),prop:"handlePersonId"}},[o("el-input",{staticStyle:{"margin-left":"18px",width:"200px"},on:{focus:e.handlechooseStock},model:{value:e.handlePersonId,callback:function(t){e.handlePersonId=t},expression:"handlePersonId"}}),e._v(" "),o("my-emp",{attrs:{control:e.stockControl},on:{"update:control":function(t){e.stockControl=t},stockName:e.stockName}})],1)],1),e._v(" "),o("el-col",{attrs:{span:6}},[o("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("income.deptId")}},[o("el-select",{staticStyle:{"margin-left":"18px",width:"200px"},on:{focus:e.change},model:{value:e.personalForm.deptId,callback:function(t){e.$set(e.personalForm,"deptId",t)},expression:"personalForm.deptId"}},e._l(e.depts,function(e,t){return o("el-option",{key:t,attrs:{value:e.id,label:e.deptName}})}))],1)],1),e._v(" "),o("el-col",{attrs:{span:6}},[o("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("income.region"),prop:"incomeregion"}},[o("el-cascader",{staticStyle:{"margin-left":"18px",width:"200px"},attrs:{options:e.regions,props:e.props,"show-all-levels":!1,placeholder:e.$t("Hmodule.xzqy"),"change-on-select":"",filterable:"",clearable:""},on:{change:e.handlechange4},model:{value:e.personalForm.incomeregion,callback:function(t){e.$set(e.personalForm,"incomeregion",t)},expression:"personalForm.incomeregion"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:6}},[o("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("income.incomeRepositoryId")}},[o("el-input",{staticStyle:{"margin-left":"18px",width:"200px"},on:{focus:e.handlechooseRep},model:{value:e.incomeRepositoryId,callback:function(t){e.incomeRepositoryId=t},expression:"incomeRepositoryId"}}),e._v(" "),o("my-repository",{attrs:{repositorycontrol:e.repositorycontrol,regionid:e.region},on:{"update:repositorycontrol":function(t){e.repositorycontrol=t},repositoryname:e.repositoryname}})],1)],1),e._v(" "),o("el-col",{attrs:{span:6}},[o("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("income.closeType")}},[o("el-select",{staticStyle:{"margin-left":"18px",width:"200px"},attrs:{clearable:""},model:{value:e.personalForm.payMode,callback:function(t){e.$set(e.personalForm,"payMode",t)},expression:"personalForm.payMode"}},e._l(e.colseTypes,function(e,t){return o("el-option",{key:t,attrs:{value:e.id,label:e.categoryName}})}))],1)],1),e._v(" "),o("el-col",{attrs:{span:6}},[o("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("income.incomeAccount")}},[o("el-input",{staticStyle:{"margin-left":"18px",width:"200px"},attrs:{clearable:""},model:{value:e.personalForm.incomeAccount,callback:function(t){e.$set(e.personalForm,"incomeAccount",t)},expression:"personalForm.incomeAccount"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:6}},[o("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("income.currency")}},[o("el-select",{staticStyle:{"margin-left":"18px",width:"200px"},model:{value:e.personalForm.currency,callback:function(t){e.$set(e.personalForm,"currency",t)},expression:"personalForm.currency"}},[o("el-option",{attrs:{value:"1",label:"PHP"}}),e._v(" "),o("el-option",{attrs:{value:"2",label:"USD"}}),e._v(" "),o("el-option",{attrs:{value:"3",label:"RMB"}})],1)],1)],1)],1)],1)],1)]),e._v(" "),o("el-card",{staticClass:"box-card",staticStyle:{"margin-top":"15px"},attrs:{shadow:"never"}},[o("h2",{ref:"fuzhu",staticClass:"form-name"},[e._v(e._s(e.$t("updates.srmx")))]),e._v(" "),o("div",{staticClass:"buttons",staticStyle:{"margin-top":"35px","margin-bottom":"10px"}},[o("el-button",{on:{click:function(t){e.insertEvent(-1)}}},[e._v(e._s(e.$t("updates.tjsrx")))]),e._v(" "),o("el-button",{attrs:{type:"danger"},on:{click:function(t){e.$refs.editable.removeSelecteds()}}},[e._v(e._s(e.$t("Hmodule.delete")))])],1),e._v(" "),o("div",{staticClass:"container"},[o("el-editable",{ref:"editable",staticClass:"click-table1",staticStyle:{width:"100%"},attrs:{data:e.list2,"edit-config":{showIcon:!0,showStatus:!0},"edit-rules":e.validRules,stripe:"",border:"",size:"medium"},on:{"update:data":function(t){e.list2=t}}},[o("el-editable-column",{attrs:{type:"selection","min-width":"55",align:"center"}}),e._v(" "),o("el-editable-column",{attrs:{label:e.$t("Hmodule.xh"),"min-width":"55",align:"center",type:"index"}}),e._v(" "),o("el-editable-column",{attrs:{"edit-render":{name:"ElInput",type:"visible"},label:e.$t("updates.zya"),prop:"summary",align:"center","min-width":"150px"}}),e._v(" "),o("el-editable-column",{attrs:{"edit-render":{name:"ElCascader",type:"visible"},label:e.$t("updates.kmmc"),prop:"subjectFinance",align:"center","min-width":"150px"},scopedSlots:e._u([{key:"edit",fn:function(t){return[o("el-cascader",{attrs:{options:e.suboptions,props:e.props2,"show-all-levels":!1,filterable:""},on:{change:function(o){e.test(t.row,o)}},model:{value:t.row.subjectFinance,callback:function(o){e.$set(t.row,"subjectFinance",o)},expression:"scope.row.subjectFinance"}})]}}])}),e._v(" "),o("el-editable-column",{attrs:{"edit-render":{name:"ElInputNumber",attrs:{min:0,precision:2},type:"visible"},label:e.$t("Hmodule.je"),prop:"money",align:"center","min-width":"150px"}})],1)],1)]),e._v(" "),o("div",{staticClass:"buttons",staticStyle:{"margin-top":"20px"}},[o("el-button",{directives:[{name:"no-more-click",rawName:"v-no-more-click"}],staticStyle:{background:"#3696fd","border-color":"#3696fd",width:"98px"},attrs:{type:"primary"},on:{click:function(t){e.handlesave()}}},[e._v(e._s(e.$t("Hmodule.baoc")))]),e._v(" "),o("el-button",{attrs:{type:"danger"},on:{click:function(t){e.handlecancel()}}},[e._v(e._s(e.$t("Hmodule.cancel")))])],1)],1)])},[],!1,null,"1737c8e9",null);p.options.__file="AddIncome.vue";t.default=p.exports}}]);