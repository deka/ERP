(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-3dba"],{GLI9:function(e,t,o){"use strict";o("Kw5r").default.directive("noMoreClick",{inserted:function(e,t){e.addEventListener("click",function(t){e.classList.add("is-disabled"),e.disabled=!0,setTimeout(function(){e.disabled=!1,e.classList.remove("is-disabled")},3e3)})}})},dr0m:function(e,t,o){},mMdc:function(e,t,o){"use strict";o.r(t);var s=o("4d7F"),n=o.n(s),r=o("gDS+"),a=o.n(r),i=o("ej3i"),l=o.n(i),c=(o("GLI9"),o("6HaC")),p=o("moiu"),d=o("Q4Eu"),m=o("+Khs"),u=o("41Be"),f=o("1ZjH"),g=o("XiP3"),h={name:"NewApprovalProcess",directives:{permission:d.a,permission2:m.a},components:{MyEmp:f.a,MyEmp2:g.a},data:function(){return{checklist:[],kongscope:"",step:1,stepHandler:"",handlerName:"",empcontrol:!1,empcontrol2:!1,categorys:[],validRules:{handlerName:[{required:!0,message:"请选择审批人",trigger:"change"}],money:[{validator:function(e,t,o){var s=Number(t),n=l()(s);console.log("value1222222222222222",n),n?o():o(new Error("请输入数字类型"))},trigger:"blur"}]},moreaction:"",loading:!1,list2:[],regions:[],repositories:[],props:{value:"id",label:"regionName",children:"regionListVos"},personalForm:{is_effective:"1",is_message:"1",createPersonId:this.$store.getters.userId,region:[]},personalrules:{is_effective:[{required:!0,message:"请选择启用状态",trigger:"change"}],process_name:[{required:!0,message:"请输入流程名称",trigger:"blur"}],type:[{required:!0,message:"请选择单据类型",trigger:"change"}],region:[{required:!0,message:"请选择区域",trigger:"change"}]}}},created:function(){this.getnationlist(),this.getRegion()},beforeCreate:function(){this},methods:{getRegion:function(){var e=this;Object(c.s)(this.$store.getters.regionId).then(function(t){if(200===t.data.ret&&null!==t.data.data.content.zcc&&""!==t.data.data.content.zcc&&void 0!==t.data.data.content.zcc){var o=t.data.data.content.zcc.split(",");e.personalForm.region=o.map(function(e){return parseInt(e)}),console.log("this.personalForm.region",e.personalForm.region)}})},chuli:function(e,t){console.log(t),console.log(e),this.kongscope.row.handlerName=t.personName,this.kongscope.row.stepHandler=t.id,console.log(e.row.step),null===this.kongscope.row.step&&(this.kongscope.row.step=e.$index+1)},handlechoose2:function(){this.empcontrol2=!0,this.checklist=this.$refs.editable.getRecords()},personName:function(e,t){this.kongscope.row.handlerName=t,this.kongscope.row.stepHandlerName=t,console.log(" this.kongscope.row.handlerName",this.kongscope.row.handlerName)},personIds:function(e,t){this.kongscope.row.stepHandler=","+t+",",console.log("this.kongscope.row.stepHandler",this.kongscope.row.stepHandler)},checkPermission:u.a,getnationlist:function(){var e=this;Object(c.J)(this.$store.getters.regionId).then(function(t){console.log(t),200===t.data.ret?e.repositories=t.data.data.content.list:e.$notify.error({title:"wrong",message:"wrong",offset:100})}),Object(c.E)().then(function(t){200===t.data.ret&&(e.regions=e.tranKTree(t.data.data.content))}),Object(p.x)().then(function(t){200===t.data.ret&&(e.categorys=t.data.data.content)})},tranKTree:function(e){var t=this;if(e&&e.length)return e.map(function(e){return{id:e.id,regionName:e.regionName,regionListVos:t.tranKTree(e.regionListVos)}})},handlechange4:function(e){var t=this,o=e[e.length-1];this.personalForm.effect_region=o,Object(c.J)(o).then(function(e){console.log(e),200===e.data.ret?t.repositories=e.data.data.content.list:t.$notify.error({title:"wrong",message:"wrong",offset:100})})},restAllForm:function(){this.personalForm={createPersonId:this.$store.getters.userId,is_effective:"1",is_message:"1"},this.getRegion()},handlesave:function(){var e=this;console.log(this.personalForm);var t=this.$refs.editable.getRecords();if(0===this.$refs.editable.getRecords().length)return this.$notify.error({title:"wrong",message:"请填写细则",offset:100}),!1;this.$refs.personalForm.validate(function(o){o?e.$refs.editable.validate(function(o){if(!o)return e.$notify.error({title:"wrong",message:"信息未填写完整",offset:100}),!1;1===t.length?t[0].money="":t[t.length-1].money="",console.log(t);var s=a()(t),n=e.personalForm.region[e.personalForm.region.length-1];e.personalForm.effect_region=n,Object(p.f)(e.personalForm,s).then(function(t){if(console.log(t),200!==t.data.ret)return e.$notify.error({title:"wrong",message:t.data.msg,offset:100}),!1;e.$notify({title:"successful",message:"save successful",type:"success",offset:100}),e.restAllForm(),e.$refs.personalForm.clearValidate(),e.$refs.personalForm.resetFields(),e.$refs.editable.clear()})}):e.$notify.error({title:"wrong",message:"信息未填写完整",offset:100})})},handlecancel:function(){this.$router.go(-1);this.$store.dispatch("delView",{path:"/BasicSettings/NewApprovalProcess",name:"NewApprovalProcess",fullPath:"/BasicSettings/NewApprovalProcess",title:"NewApprovalProcess"}).then(function(e){e.visitedViews})},handlechoose:function(e){if(this.empcontrol2=!0,console.log(e),e.row.stepHandler){for(var t=e.row.stepHandler,o=(t=t.replace(/,/g," ")).split(" "),s=e.row.stepHandlerName.split(","),n=0;n<o.length;n++)""===o[n]&&(o.splice(n,1),n--);console.log("aaa",o);for(var r=[],a=0;a<o.length;a++){var i={personName:s[a],id:o[a]};r.push(i)}this.checklist=r,console.log(this.checklist)}this.kongscope=e,this.kongscope.row.step=e.$index+1},fuzhi:function(e){e.row.handlerName=this.handlerName},handleStep:function(e){console.log(e)},postJSON:function(e){return new n.a(function(e){setTimeout(function(){e("save successful")},300)})},selectEvent:function(e,t){console.log(e),console.log(t)},insertEvent:function(e){this.$refs.editable.insertAt({step:null},e)},currentChangeEvent:function(e,t){console.log(e)}}},v=(o("zejO"),o("KHd+")),b=Object(v.a)(h,function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ERP-container"},[o("div",{staticClass:"app-container"},[o("h2",{ref:"geren",staticClass:"form-name"},[e._v(e._s(e.$t("Hmodule.basicinfo")))]),e._v(" "),o("div",{staticClass:"container"},[o("el-form",{ref:"personalForm",staticClass:"demo-ruleForm",staticStyle:{"margin-left":"30px"},attrs:{model:e.personalForm,rules:e.personalrules,inline:!0,"status-icon":"","label-position":"top","label-width":"300px"}},[o("el-form-item",{staticStyle:{width:"40%","margin-top":"1%"},attrs:{label:e.$t("BasicSettings.process_name"),prop:"process_name"}},[o("el-input",{attrs:{placeholder:"请输入流程名称",clearable:""},model:{value:e.personalForm.process_name,callback:function(t){e.$set(e.personalForm,"process_name",t)},expression:"personalForm.process_name"}})],1),e._v(" "),o("el-form-item",{staticStyle:{width:"40%","margin-top":"1%"},attrs:{label:e.$t("BasicSettings.is_effective"),prop:"is_effective"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择启用状态"},model:{value:e.personalForm.is_effective,callback:function(t){e.$set(e.personalForm,"is_effective",t)},expression:"personalForm.is_effective"}},[o("el-option",{attrs:{label:"on duty",value:"1"}}),e._v(" "),o("el-option",{attrs:{label:"closed",value:"2"}})],1)],1),e._v(" "),o("el-form-item",{staticStyle:{width:"40%","margin-top":"1%"},attrs:{label:e.$t("BasicSettings.type3"),prop:"type"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择单据类型",filterable:""},model:{value:e.personalForm.type,callback:function(t){e.$set(e.personalForm,"type",t)},expression:"personalForm.type"}},e._l(e.categorys,function(e,t){return o("el-option",{key:t,attrs:{value:e.id,label:e.categoryName}})}))],1),e._v(" "),o("el-form-item",{staticStyle:{width:"40%","margin-top":"1%"},attrs:{label:e.$t("BasicSettings.is_message")}},[o("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("updates.qxz")},model:{value:e.personalForm.is_message,callback:function(t){e.$set(e.personalForm,"is_message",t)},expression:"personalForm.is_message"}},[o("el-option",{attrs:{label:"发送",value:"1"}}),e._v(" "),o("el-option",{attrs:{label:"不发送",value:"2"}})],1)],1),e._v(" "),o("el-form-item",{staticStyle:{width:"40%","margin-top":"1%"},attrs:{label:e.$t("BasicSettings.effect_region"),prop:"region"}},[o("el-cascader",{staticStyle:{width:"100%"},attrs:{options:e.regions,props:e.props,placeholder:e.$t("Hmodule.xzqy"),"change-on-select":"",filterable:"",clearable:""},on:{change:e.handlechange4},model:{value:e.personalForm.region,callback:function(t){e.$set(e.personalForm,"region",t)},expression:"personalForm.region"}})],1),e._v(" "),o("el-form-item",{staticStyle:{width:"40%","margin-top":"1%"},attrs:{label:e.$t("BasicSettings.effect_repository")}},[o("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("Hmodule.xzmd")},model:{value:e.personalForm.effect_repository,callback:function(t){e.$set(e.personalForm,"effect_repository",t)},expression:"personalForm.effect_repository"}},e._l(e.repositories,function(e,t){return o("el-option",{key:t,attrs:{label:e.repositoryName,value:e.id}})}))],1)],1)],1),e._v(" "),o("h2",{ref:"fuzhu",staticClass:"form-name"},[e._v(e._s(e.$t("updates.splcbz")))]),e._v(" "),o("div",{staticClass:"buttons",staticStyle:{"margin-top":"50px"}},[o("el-button",{attrs:{type:"success"},on:{click:function(t){e.insertEvent(-1)}}},[e._v(e._s(e.$t("updates.tj")))]),e._v(" "),o("el-button",{attrs:{type:"danger"},on:{click:function(t){e.$refs.editable.removeSelecteds()}}},[e._v(e._s(e.$t("Hmodule.delete")))])],1),e._v(" "),o("div",{staticClass:"container"},[o("el-editable",{ref:"editable",staticClass:"click-table1",staticStyle:{width:"100%"},attrs:{data:e.list2,"edit-config":{showIcon:!1,showStatus:!0},"edit-rules":e.validRules,stripe:"",border:"",size:"medium"},on:{select:e.selectEvent,"current-change":e.currentChangeEvent}},[o("el-editable-column",{attrs:{type:"selection",width:"55",align:"center"}}),e._v(" "),o("el-editable-column",{attrs:{label:"流程步骤",type:"index",align:"center",width:"150px"}}),e._v(" "),o("el-editable-column",{attrs:{"edit-render":{name:"ElInput",type:"visible"},prop:"description",align:"center",label:"步骤描述",width:"500px"}}),e._v(" "),o("el-editable-column",{attrs:{"edit-render":{name:"ElInput",type:"visible"},prop:"money",align:"center",label:"流转条件",width:"400px"}}),e._v(" "),o("el-editable-column",{attrs:{"edit-render":{name:"ElInput",type:"visible"},prop:"handlerName",align:"center",label:"步骤处理人","min-width":"500px"},scopedSlots:e._u([{key:"edit",fn:function(t){return[o("el-input",{on:{focus:function(o){e.handlechoose(t)},input:function(o){e.$refs.editable.updateStatus(t)},change:function(o){e.$refs.editable.updateStatus(t)}},model:{value:t.row.handlerName,callback:function(o){e.$set(t.row,"handlerName",o)},expression:"scope.row.handlerName"}}),e._v(" "),o("my-emp2",{attrs:{control:e.empcontrol2,checklist:e.checklist},on:{"update:control":function(t){e.empcontrol2=t},"update:checklist":function(t){e.checklist=t},personName:function(o){e.personName(t,o)},personIds:function(o){e.personIds(t,o)}}})]}}])})],1)],1),e._v(" "),o("div",{staticClass:"buttons",staticStyle:{"margin-top":"20px"}},[o("el-button",{directives:[{name:"no-more-click",rawName:"v-no-more-click"},{name:"permission",rawName:"v-permission",value:["1-39-46-1"],expression:"['1-39-46-1']"}],attrs:{type:"primary"},on:{click:function(t){e.handlesave()}}},[e._v(e._s(e.$t("Hmodule.baoc")))]),e._v(" "),o("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["1-39-46-1"],expression:"['1-39-46-1']"}],attrs:{type:"danger"},on:{click:function(t){e.handlecancel()}}},[e._v(e._s(e.$t("Hmodule.cancel")))])],1)])])},[],!1,null,"563f7fae",null);b.options.__file="NewApprovalProcess.vue";t.default=b.exports},zejO:function(e,t,o){"use strict";var s=o("dr0m");o.n(s).a}}]);