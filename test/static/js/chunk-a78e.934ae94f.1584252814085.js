(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-a78e"],{"7nuu":function(t,e,a){"use strict";var i=a("Q97M");a.n(i).a},Q97M:function(t,e,a){},sgfH:function(t,e,a){"use strict";a.r(e);var i=a("jWXv"),s=a.n(i),n=a("m1cH"),l=a.n(n),o=a("uNNS"),r={name:"Getauthority",data:function(){return{IsEait:!1,isShow:!1,checkAll:!1,operations:[],operates:[],details:[],treeData:[],defaultProps:{children:"authorityVos",label:"name"},list:[],total:0,tableKey:0,listLoading:!0,getemplist:{createPersonId:this.$store.getters.userId,rolename:null},checkroleId:null}},created:function(){this.getlist()},beforeCreate:function(){this},methods:{setCurrent:function(){this.$refs.singleTable.setCurrentRow(),this.IsEait=!1,this.isShow=!1,this.getemplist.rolename=null},newauthority:function(){var t=this;console.log("this.operations",this.operations),this.$confirm("所修改的角色需重新登录才能生效, 是否继续?",this.$t("prompt.ts"),{confirmButtonText:this.$t("prompt.qd"),cancelButtonText:this.$t("prompt.qx"),type:"warning"}).then(function(){Object(o.d)(t.checkroleId,t.operations,t.getemplist.rolename).then(function(e){200===e.data.ret?(t.$notify({title:"successful",message:"修改成功",type:"success",offset:100}),t.$refs.singleTable.setCurrentRow(),t.IsEait=!1,t.isShow=!1,t.getemplist.rolename=null,t.getlist()):t.$notify.error({title:"wrong",message:e.data.msg,offset:100})})}).catch(function(){t.$message({type:"info",message:"已取消修改"})})},handleCurrentChange:function(t){t.roleName&&(this.operations=[],this.IsEait=!0,console.log("val.roleName",t.roleName),this.getemplist.rolename=t.roleName,this.isShow=!1,this.checkAll=!1,null!==t.id&&void 0!==t.id&&""!==t.id&&(this.checkroleId=t.id),null!==t.authority&&void 0!==t.authority&&""!==t.authority&&(this.operations=t.authority.split(",")),null===t.authority&&(this.operations=[]),console.log(this.operations),console.log(this.getemplist.rolename))},restAllForm:function(){this.getemplist.rolename=null},newRole:function(){var t=this;Object(o.a)(this.getemplist).then(function(e){200===e.data.ret?(t.$notify({title:"successful",message:"save successful",type:"success",offset:100}),t.restAllForm(),t.getlist()):t.$notify.error({title:"wrong",message:e.data.msg,offset:100})})},handleCheckAllChange:function(t){if(!0===t){var e=[].concat(l()(new s.a([].concat(l()(this.operations),l()(this.details)))));this.operations=e}else{var a=this.details;this.operations=this.operations.filter(function(t){return a.indexOf(t)<0})}},handleCheckedCitiesChange:function(t){console.log(this.operations),console.log(t);var e=t.length;this.checkAll=e===this.details.length},recursionLevel1:function(t){return 1===t.level?t.data.id:this.recursionLevel1(t.parent)},recursionLevel2:function(t){return 2===t.level?t.data.id:this.recursionLevel2(t.parent)},recursionLevel3:function(t){return 3===t.level?t.data.id:this.recursionLevel3(t.parent)},handleNodeClick:function(t,e){console.log(e),console.log(t);var a=this.recursionLevel1(e),i=this.recursionLevel2(e);if(null!==t.authorityDetails){if(this.isShow=!0,3===e.level)this.operates=t.authorityDetails.map(function(e){return{id:a+"-"+i+"-"+t.id+"-"+e.id,name:e.name}}),this.details=t.detail.split(",").map(function(e){return a+"-"+i+"-"+t.id+"-"+Number(e)});else if(2===e.level)this.operates=t.authorityDetails.map(function(e){return{id:a+"-"+t.id+"-"+e.id,name:e.name}}),this.details=t.detail.split(",").map(function(e){return a+"-"+t.id+"-"+Number(e)});else if(4===e.level){var s=this.recursionLevel3(e);this.operates=t.authorityDetails.map(function(e){return{id:a+"-"+i+"-"+s+"-"+t.id+"-"+e.id,name:e.name}}),this.details=t.detail.split(",").map(function(e){return a+"-"+i+"-"+s+"-"+t.id+"-"+Number(e)})}console.log(this.operations);var n=this.isContain(this.operations,this.details);console.log(n),!0===n?this.checkAll=!0:!1===n&&(this.checkAll=!1)}else this.operates=[],this.details=[]},isContain:function(t,e){for(var a=e.length-1;a>=0;a--)if(!t.includes(e[a]))return!1;return!0},getlist:function(){var t=this;this.listLoading=!0,Object(o.c)().then(function(e){200===e.data.ret&&(t.list=e.data.data.content),setTimeout(function(){t.listLoading=!1},50)}),Object(o.b)().then(function(e){200===e.data.ret&&(t.treeData=e.data.data.content)})},handlecancel:function(){this.$router.go(-1);this.$store.dispatch("delView",{path:"/GroupBuyRules/AddGroupBuyRules",name:"AddGroupBuyRules",fullPath:"/GroupBuyRules/AddGroupBuyRules",title:"AddGroupBuyRules"}).then(function(t){t.visitedViews})}}},c=(a("7nuu"),a("KHd+")),u=Object(c.a)(r,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ERP-container"},[a("div",{staticClass:"app-container",staticStyle:{"padding-right":"0"}},[a("el-card",{staticClass:"box-card",staticStyle:{height:"800px"},attrs:{shadow:"never"}},[a("el-row",{attrs:{gutter:20}},[a("el-form",{ref:"getemplist",staticStyle:{"margin-top":"10px"},attrs:{model:t.getemplist,"label-width":"100px"}},[a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:t.$t("updates.jsmc"),"label-width":"100px"}},[a("el-input",{attrs:{placeholder:t.$t("Getauthority.rolename"),clearable:""},model:{value:t.getemplist.rolename,callback:function(e){t.$set(t.getemplist,"rolename",e)},expression:"getemplist.rolename"}})],1)],1),t._v(" "),a("el-col",{directives:[{name:"show",rawName:"v-show",value:!1===t.IsEait,expression:"IsEait === false"}],attrs:{span:2}},[a("el-button",{staticClass:"filter-item",staticStyle:{width:"86px"},attrs:{type:"primary"},on:{click:t.newRole}},[t._v(t._s(t.$t("public.add")))])],1),t._v(" "),a("el-col",{directives:[{name:"show",rawName:"v-show",value:t.IsEait,expression:"IsEait"}],attrs:{span:2}},[a("el-button",{staticClass:"filter-item",staticStyle:{width:"86px"},attrs:{type:"success"},on:{click:t.newauthority}},[t._v(t._s(t.$t("public.edit")))])],1),t._v(" "),a("el-col",{directives:[{name:"show",rawName:"v-show",value:t.IsEait,expression:"IsEait"}],attrs:{span:2}},[a("el-button",{staticClass:"filter-item",staticStyle:{width:"86px"},attrs:{type:"warning"},on:{click:function(e){t.setCurrent()}}},[t._v(t._s(t.$t("public.cancel")))])],1)],1)],1),t._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"container",staticStyle:{"margin-top":"20px"}},[a("div",{staticStyle:{width:"100%",border:"1px solid #ebeef5","border-bottom":"none",height:"30px","padding-top":"5px","padding-left":"28px",color:"#606266"}},[t._v(t._s(t.$t("updates.jslb")))]),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],key:t.tableKey,ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:t.list,border:"",fit:"","max-height":"650","highlight-current-row":""},on:{"current-change":t.handleCurrentChange}},[a("el-table-column",{attrs:{label:t.$t("Getauthority.rolename"),resizable:!1,align:"center","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.roleName))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("Getauthority.createTime"),resizable:!1,align:"center","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.createTime))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("Getauthority.createPersonName"),resizable:!1,align:"center","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.createPersonName))])]}}])})],1)],1)]),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"container5",staticStyle:{"margin-top":"20px"}},[a("div",{staticStyle:{width:"100%",border:"1px solid #ebeef5","border-bottom":"none",height:"30px","padding-top":"5px","padding-left":"28px",color:"#606266"}},[t._v(t._s(t.$t("updates.mkmc")))]),t._v(" "),a("el-card",{staticClass:"box-card",staticStyle:{height:"800px"},attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v(t._s(t.$t("updates.name")))])]),t._v(" "),a("el-scrollbar",{staticClass:"tree"},[a("el-tree",{attrs:{data:t.treeData,props:t.defaultProps,accordion:"","highlight-current":""},on:{"node-click":t.handleNodeClick}})],1)],1)],1)]),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"container3",staticStyle:{"margin-top":"20px"}},[a("div",{staticStyle:{width:"100%",border:"1px solid #ebeef5","border-bottom":"none",height:"30px","padding-top":"5px","padding-left":"28px",color:"#606266"}},[t._v(t._s(t.$t("updates.czqx")))]),t._v(" "),a("el-card",{staticClass:"box-card",staticStyle:{height:"655px","overflow-y":"auto"},attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v(t._s(t.$t("updates.name")))]),t._v(" "),a("el-checkbox",{staticStyle:{float:"right","margin-bottom":"-5px"},on:{change:t.handleCheckAllChange},model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}},[t._v(t._s(t.$t("updates.qx")))])],1),t._v(" "),t.isShow?a("div",{staticClass:"upsides"},[a("el-checkbox-group",{on:{change:t.handleCheckedCitiesChange},model:{value:t.operations,callback:function(e){t.operations=e},expression:"operations"}},t._l(t.operates,function(e,i){return a("div",{key:i,staticClass:"text item"},[a("el-checkbox",{attrs:{label:e.id}},[t._v(t._s(e.name))])],1)}))],1):t._e()])],1)])],1)],1)],1)])},[],!1,null,"7d32e28e",null);u.options.__file="index.vue";e.default=u.exports},uNNS:function(t,e,a){"use strict";a.d(e,"c",function(){return s}),a.d(e,"b",function(){return n}),a.d(e,"a",function(){return l}),a.d(e,"d",function(){return o});var i=a("t3Un");function s(){return Object(i.a)({url:"/role/getrolelist",method:"post"})}function n(){return Object(i.a)({url:"/role/getauthoritydetaillist",method:"post"})}function l(t){var e=new URLSearchParams;return""!==t.rolename&&null!==t.rolename&&void 0!==t.rolename&&e.append("rolename",t.rolename),""!==t.createPersonId&&null!==t.createPersonId&&void 0!==t.createPersonId&&e.append("createPersonId",t.createPersonId),Object(i.a)({url:"/role/addrole",method:"post",data:e})}function o(t,e,a){var s=new URLSearchParams;return s.append("roleid",t),s.append("roleName",a),s.append("authority",e),Object(i.a)({url:"/role/updaterole",method:"post",data:s})}}}]);