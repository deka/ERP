(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-346b"],{"62VS":function(e,t,s){"use strict";var o=s("TlwX");s.n(o).a},GLI9:function(e,t,s){"use strict";s("Kw5r").default.directive("noMoreClick",{inserted:function(e,t){e.addEventListener("click",function(t){e.classList.add("is-disabled"),e.disabled=!0,setTimeout(function(){e.disabled=!1,e.classList.remove("is-disabled")},3e3)})}})},TlwX:function(e,t,s){},VKSf:function(e,t,s){"use strict";s.r(t);var o=s("gDS+"),n=s.n(o),r=s("6UR4"),a=s("jeq2"),i=(s("GLI9"),s("dTa6")),l=s("/PQ/"),c=s("6HaC"),d=s("rwJ9"),p=s("moiu"),u=s("i2Rm"),m={name:"AddExpenses",components:{MyRepository:s("J3n6").a,MyEmp:u.a},data:function(){var e=this;return{accounts:[],accountsparm:{pageNum:1,pageSize:1e6,isEffective:"1"},suboptions:[],pickerOptions1:{disabledDate:function(e){return e.getTime()<(new Date).getTime()-864e5}},treedata:[],regions:[],region:null,props:{value:"id",label:"regionName",children:"regionListVos"},props2:{value:"id",label:"subjectName",children:"subjectFinanceVos"},colseTypes:[],payModes:[],colseTypeparms:{type:3,pagenum:1,pagesize:99999},expensesRepositoryId:"",repositorycontrol:!1,choosedata:[],depts:[],handlePersonId:this.$store.getters.name,stockControl:!1,personalForm:{isVoucher:1,createPersonId:this.$store.getters.userId,countryId:this.$store.getters.countryId,repositoryId:this.$store.getters.repositoryId,regionId:this.$store.getters.regionId,currency:"1",handlePersonId:this.$store.getters.userId,expensesRegionId:this.$store.getters.regionId},personalrules:{handlePersonId:[{required:!0,validator:function(t,s,o){void 0===e.handlePersonId||null===e.handlePersonId||""===e.handlePersonId?o(new Error("请选择经办人")):o()},trigger:"change"}],expensesDate:[{required:!0,message:"请选择支出日期",trigger:"change"}]},list2:[],validRules:{}}},created:function(){this.getdatatime(),this.getTypes(),this.gettree()},beforeCreate:function(){this},methods:{switchtreedata:function(e){for(var t in e)""===e[t].subjectNumber||null===e[t].subjectNumber?this.switchtreedata(e[t].subjectFinanceVos):(e[t].level>3&&this.switchtreedata(e[t].subjectFinanceVos),e[t].subjectName=e[t].subjectNumber+e[t].subjectName)},getaccounts:function(){var e=this;Object(r.c)(this.accountsparm).then(function(t){200===t.data.ret&&(e.accounts=t.data.data.content.list)})},getarrs:function(){console.log("222",222),console.log("北京市朝阳区爱谁谁"),console.log("this.personalForm",this.personalForm),console.log("this.regions",this.regions);var e=this.findPathByLeafId(this.personalForm.expensesRegionId,this.regions);console.log("needata",e),this.personalForm.expensesregion=e;var t=e[e.length-1];console.log(t),this.region=t},findPathByLeafId:function(e,t,s){void 0===s&&(s=[]);for(var o=0;o<t.length;o++){var n=s.concat();if(n.push(t[o].id),e===t[o].id)return n;if(t[o].regionListVos){var r=this.findPathByLeafId(e,t[o].regionListVos,n);if(r)return r}}},findtreedata:function(e,t){var s=this,o=void 0;return(e||[]).map(function(e){if(e.id===t)o=e;else{var n=s.findtreedata(e.subjectFinanceVos,t);n&&(o=n)}}),o},processchildren:function(e){for(var t in e)0===e[t].subjectFinanceVos.length?delete e[t].subjectFinanceVos:this.processchildren(e[t].subjectFinanceVos);return e},test:function(e,t){console.log(e,t);var s=t[t.length-1],o=this.findtreedata(this.treedata,s);console.log("needata",o),e.subjectName=o.subjectName,e.subjectCode=o.subjectNumber,console.log("this.treedata",this.treedata)},gettree:function(){var e=this;console.log(123),Object(a.g)().then(function(t){if(200===t.data.ret){var s=t.data.data.content;e.switchtreedata(s);e.suboptions=e.processchildren(s),e.treedata=t.data.data.content}}),console.log(321)},tranKTree:function(e){var t=this;if(e&&e.length)return e.map(function(e){return{id:e.id,regionName:e.regionName,regionListVos:t.tranKTree(e.regionListVos)}})},handlechange4:function(e){console.log(e);var t=e[e.length-1];console.log(t),this.region=t,this.personalForm.expensesregionId=t},insertEvent:function(e){this.$refs.editable.insertAt({productCode:null},e)},getTypes:function(){var e=this;console.log("this.$store.getters.repositoryId",this.$store.getters.repositoryId),0!==this.$store.getters.repositoryId&&null!==this.$store.getters.repositoryId&&void 0!==this.$store.getters.repositoryId&&""!==this.$store.getters.repositoryId&&(this.expensesRepositoryId=this.$store.getters.repositoryName,this.personalForm.expensesRepositoryId=this.$store.getters.repositoryId),Object(l.j)(7).then(function(t){200===t.data.ret&&(e.payModes=t.data.data.content.list)}),Object(p.p)().then(function(t){200===t.data.ret&&(e.depts=t.data.data.content)}),Object(d.c)(this.colseTypeparms).then(function(t){200===t.data.ret&&(e.colseTypes=t.data.data.content.list)}),Object(c.E)().then(function(t){200===t.data.ret?(e.regions=e.tranKTree(t.data.data.content),e.getarrs()):console.log("区域列表出错")})},getdatatime:function(){var e=new Date,t=e.getFullYear(),s=e.getMonth()+1,o=e.getDate();s>=1&&s<=9&&(s="0"+s),o>=0&&o<=9&&(o="0"+o);var n=t+"-"+s+"-"+o;this.personalForm.expensesDate=n},handlechooseRep:function(){if(null===this.region||""===this.region||void 0===this.region)return this.$notify.error({title:"wrong",message:"请先选择区域",offset:100}),!1;this.repositorycontrol=!0},repositoryname:function(e){this.expensesRepositoryId=e.repositoryName,this.personalForm.expensesRepositoryId=e.id},change:function(){this.$forceUpdate()},handlechooseStock:function(){this.stockControl=!0},stockName:function(e){console.log(e),this.personalForm.deptId=e.deptId,this.expensesRepositoryId=e.repositoryName,this.personalForm.expensesRepositoryId=e.repositoryId,this.handlePersonId=e.personName,this.personalForm.handlePersonId=e.id},restAllForm:function(){},handlesave:function(){var e=this,t=this.$refs.editable.getRecords();if(0===t.length)return this.$notify.error({title:"wrong",message:this.$t("prompt.mxbbnwk"),offset:100}),!1;var s=1;if(t.map(function(e){return e}).forEach(function(e){return delete e.productCode,null!==e.subjectCode&&""!==e.subjectCode&&void 0!==e.subjectCode||(s=2),null!==e.summary&&""!==e.summary&&void 0!==e.summary||delete e.summary,null!==e.subjectFinanceId&&""!==e.subjectFinanceId&&void 0!==e.subjectFinanceId||delete e.subjectFinanceId,null!==e.money&&""!==e.money&&void 0!==e.money||delete e.money,e}),2===s)return this.$notify.error({title:"wrong",message:"科目名称必选",offset:100}),!1;var o=n()(t),r=this.personalForm;for(var a in r)""!==r[a]&&void 0!==r[a]&&null!==r[a]||delete r[a];var l=n()(r);this.$refs.personalForm.validate(function(t){if(!t)return e.$notify.error({title:"wrong",message:"Information is incomplete",offset:100}),!1;e.$refs.editable.validate().then(function(t){Object(i.a)(l,o,e.personalForm).then(function(t){console.log(t),200===t.data.ret?(e.$notify({title:"successful",message:"save successful",type:"success",offset:100}),e.restAllForm(),e.$refs.editable.clear(),e.$refs.personalForm.clearValidate(),e.$refs.personalForm.resetFields()):e.$notify.error({title:"wrong",message:t.data.msg,offset:100})})}).catch(function(e){console.log("error submit!!")})})},handlecancel:function(){this.$router.go(-1);this.$store.dispatch("delView",{path:"/Expenses/AddExpenses",name:"AddExpenses",fullPath:"/Expenses/AddExpenses",title:"AddExpenses"}).then(function(e){e.visitedViews})}}},h=(s("62VS"),s("KHd+")),f=Object(h.a)(m,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ERP-container"},[s("div",{staticClass:"app-container",staticStyle:{"padding-right":"0"}},[s("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[s("h2",{ref:"geren",staticClass:"form-name"},[e._v(e._s(e.$t("Hmodule.basicinfo")))]),e._v(" "),s("div",{staticClass:"container",staticStyle:{"margin-top":"37px"}},[s("el-form",{ref:"personalForm",staticClass:"demo-ruleForm",attrs:{model:e.personalForm,rules:e.personalrules,inline:!0,"status-icon":"","label-width":"130px"}},[s("el-row",[s("el-col",{attrs:{span:6}},[s("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("Expenses.title")}},[s("el-input",{staticStyle:{"margin-left":"18px",width:"200px"},attrs:{clearable:""},model:{value:e.personalForm.title,callback:function(t){e.$set(e.personalForm,"title",t)},expression:"personalForm.title"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("Expenses.expensesDate"),prop:"ExpensesDate"}},[s("el-date-picker",{staticStyle:{"margin-left":"18px",width:"200px"},attrs:{"picker-options":e.pickerOptions1,type:"date","value-format":"yyyy-MM-dd"},model:{value:e.personalForm.expensesDate,callback:function(t){e.$set(e.personalForm,"expensesDate",t)},expression:"personalForm.expensesDate"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("Expenses.handlePersonId"),prop:"handlePersonId"}},[s("el-input",{staticStyle:{"margin-left":"18px",width:"200px"},on:{focus:e.handlechooseStock},model:{value:e.handlePersonId,callback:function(t){e.handlePersonId=t},expression:"handlePersonId"}}),e._v(" "),s("my-emp",{attrs:{control:e.stockControl},on:{"update:control":function(t){e.stockControl=t},stockName:e.stockName}})],1)],1),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("Expenses.deptId")}},[s("el-select",{staticStyle:{"margin-left":"18px",width:"200px"},on:{focus:e.change},model:{value:e.personalForm.deptId,callback:function(t){e.$set(e.personalForm,"deptId",t)},expression:"personalForm.deptId"}},e._l(e.depts,function(e,t){return s("el-option",{key:t,attrs:{value:e.id,label:e.deptName}})}))],1)],1),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("income.region"),prop:"expensesregion"}},[s("el-cascader",{staticStyle:{"margin-left":"18px",width:"200px"},attrs:{options:e.regions,props:e.props,"show-all-levels":!1,placeholder:e.$t("Hmodule.xzqy"),"change-on-select":"",filterable:"",clearable:""},on:{change:e.handlechange4},model:{value:e.personalForm.expensesregion,callback:function(t){e.$set(e.personalForm,"expensesregion",t)},expression:"personalForm.expensesregion"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("Expenses.expensesRepositoryId")}},[s("el-input",{staticStyle:{"margin-left":"18px",width:"200px"},on:{focus:e.handlechooseRep},model:{value:e.expensesRepositoryId,callback:function(t){e.expensesRepositoryId=t},expression:"expensesRepositoryId"}}),e._v(" "),s("my-repository",{attrs:{repositorycontrol:e.repositorycontrol,regionid:e.region},on:{"update:repositorycontrol":function(t){e.repositorycontrol=t},repositoryname:e.repositoryname}})],1)],1),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("Expenses.closeType")}},[s("el-select",{staticStyle:{"margin-left":"18px",width:"200px"},attrs:{clearable:""},model:{value:e.personalForm.payMode,callback:function(t){e.$set(e.personalForm,"payMode",t)},expression:"personalForm.payMode"}},e._l(e.payModes,function(e,t){return s("el-option",{key:t,attrs:{value:e.id,label:e.categoryName}})}))],1)],1),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("Expenses.expensesAccount"),prop:"transferInAccount"}},[s("el-select",{staticStyle:{"margin-left":"18px",width:"200px"},on:{focus:e.getaccounts},model:{value:e.personalForm.expensesAccount,callback:function(t){e.$set(e.personalForm,"expensesAccount",t)},expression:"personalForm.expensesAccount"}},e._l(e.accounts,function(e,t){return s("el-option",{key:t,attrs:{label:e.accountNumber,value:e.accountNumber}})}))],1)],1),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("Expenses.currency")}},[s("el-select",{staticStyle:{"margin-left":"18px",width:"200px"},model:{value:e.personalForm.currency,callback:function(t){e.$set(e.personalForm,"currency",t)},expression:"personalForm.currency"}},[s("el-option",{attrs:{value:"1",label:"PHP"}}),e._v(" "),s("el-option",{attrs:{value:"2",label:"USD"}}),e._v(" "),s("el-option",{attrs:{value:"3",label:"RMB"}})],1)],1)],1)],1)],1)],1)]),e._v(" "),s("el-card",{staticClass:"box-card",staticStyle:{"margin-top":"15px"},attrs:{shadow:"never"}},[s("h2",{ref:"fuzhu",staticClass:"form-name"},[e._v(e._s(e.$t("updates.zcmx")))]),e._v(" "),s("div",{staticClass:"buttons",staticStyle:{"margin-top":"35px","margin-bottom":"10px"}},[s("el-button",{on:{click:function(t){e.insertEvent(-1)}}},[e._v(e._s(e.$t("tongyo.tjzcx")))]),e._v(" "),s("el-button",{attrs:{type:"danger"},on:{click:function(t){e.$refs.editable.removeSelecteds()}}},[e._v(e._s(e.$t("Hmodule.delete")))])],1),e._v(" "),s("div",{staticClass:"container"},[s("el-editable",{ref:"editable",staticClass:"click-table1",staticStyle:{width:"100%"},attrs:{data:e.list2,"edit-config":{showIcon:!0,showStatus:!0},"edit-rules":e.validRules,stripe:"",border:"",size:"medium"},on:{"update:data":function(t){e.list2=t}}},[s("el-editable-column",{attrs:{type:"selection","min-width":"55",align:"center"}}),e._v(" "),s("el-editable-column",{attrs:{label:e.$t("Hmodule.xh"),"min-width":"55",align:"center",type:"index"}}),e._v(" "),s("el-editable-column",{attrs:{"edit-render":{name:"ElInput",type:"visible"},label:e.$t("updates.zya"),prop:"summary",align:"center","min-width":"150px"}}),e._v(" "),s("el-editable-column",{attrs:{"edit-render":{name:"ElCascader ",type:"visible",options:"options"},label:e.$t("updates.kmmc"),prop:"subjectFinance",align:"center","min-width":"150px"},scopedSlots:e._u([{key:"edit",fn:function(t){return[s("el-cascader",{attrs:{options:e.suboptions,props:e.props2,"show-all-levels":!1,filterable:""},on:{change:function(s){e.test(t.row,s)}},model:{value:t.row.subjectFinance,callback:function(s){e.$set(t.row,"subjectFinance",s)},expression:"scope.row.subjectFinance"}})]}}])}),e._v(" "),s("el-editable-column",{attrs:{"edit-render":{name:"ElInputNumber",attrs:{min:0,precision:2},type:"visible"},label:e.$t("Hmodule.je"),prop:"money",align:"center","min-width":"150px"}})],1)],1)]),e._v(" "),s("div",{staticClass:"buttons",staticStyle:{"margin-top":"20px"}},[s("el-button",{directives:[{name:"no-more-click",rawName:"v-no-more-click"}],staticStyle:{background:"#3696fd","border-color":"#3696fd",width:"98px"},attrs:{type:"primary"},on:{click:function(t){e.handlesave()}}},[e._v(e._s(e.$t("Hmodule.baoc")))]),e._v(" "),s("el-button",{attrs:{type:"danger"},on:{click:function(t){e.handlecancel()}}},[e._v(e._s(e.$t("Hmodule.cancel")))])],1)],1)])},[],!1,null,"497f13d4",null);f.options.__file="AddExpenses.vue";t.default=f.exports}}]);