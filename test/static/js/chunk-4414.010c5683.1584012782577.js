(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-4414"],{GLI9:function(e,t,r){"use strict";r("Kw5r").default.directive("noMoreClick",{inserted:function(e,t){e.addEventListener("click",function(t){e.classList.add("is-disabled"),e.disabled=!0,setTimeout(function(){e.disabled=!1,e.classList.remove("is-disabled")},3e3)})}})},KsGA:function(e,t,r){"use strict";var s=r("yjmD");r.n(s).a},lVES:function(e,t,r){"use strict";r.r(t);var s=r("gDS+"),n=r.n(s),o=(r("GLI9"),r("6UR4")),i=r("jeq2"),a=r("ckf6"),l=r("rwJ9"),c=r("moiu"),d=r("6HaC"),u=r("Xht5"),p={name:"AddTransfer",components:{MyRepository:r("3M7Q").a,MyEmp:u.a},data:function(){var e=this;return{accounts:[],accountsparm:{pageNum:1,pageSize:1e6,isEffective:"1"},repositories:[],suboptions:[],props2:{value:"id",label:"subjectName",children:"subjectFinanceVos"},needreglist:[],region:null,pickerOptions1:{disabledDate:function(e){return e.getTime()<(new Date).getTime()-864e5}},props:{value:"id",label:"regionName",children:"regionListVos"},transferRepositoryId:this.$store.getters.repositoryName,regions:[],colseTypes:[],colseTypeparms:{type:3,pagenum:1,pagesize:99999},repositorycontrol:!1,choosedata:[],depts:[],stockControl:!1,handlePersonId:this.$store.getters.name,personalForm:{createPersonId:this.$store.getters.userId,countryId:this.$store.getters.countryId,repositoryId:this.$store.getters.repositoryId,regionId:this.$store.getters.regionId,handlePersonId:this.$store.getters.userId,currency:"1",direction:"1",transferType:"1"},personalrules:{handlePersonId:[{required:!0,validator:function(t,r,s){void 0===e.handlePersonId||null===e.handlePersonId||""===e.handlePersonId?s(new Error("请选择经办人")):s()},trigger:"change"}],transferDate:[{required:!0,message:"请选择收款日期",trigger:"change"}],transferRegion:[{required:!0,validator:function(t,r,s){void 0===e.personalForm.transferRegionId||null===e.personalForm.transferRegionId||""===e.personalForm.transferRegionId?s(new Error("请选择区域")):s()},trigger:"change"}],transferInAccount:[{required:!0,message:"请选择账户",trigger:"change"}]},list2:[],validRules:{}}},created:function(){this.getdatatime(),this.getTypes(),this.gettree(),this.handlechange4()},beforeCreate:function(){this},methods:{switchtreedata:function(e){for(var t in e)""===e[t].subjectNumber||null===e[t].subjectNumber?this.switchtreedata(e[t].subjectFinanceVos):(e[t].level>3&&this.switchtreedata(e[t].subjectFinanceVos),e[t].subjectName=e[t].subjectNumber+e[t].subjectName)},setbank:function(e){var t=this.accounts.filter(function(t){return t.accountNumber===e});console.log("bankdata",t),this.personalForm.transferInBank=t[0].bank},getaccounts:function(){var e=this;Object(o.c)(this.accountsparm).then(function(t){200===t.data.ret&&(e.accounts=t.data.data.content.list)})},handlechange4:function(){var e=this;Object(d.K)().then(function(t){console.log(t),200===t.data.ret?e.repositories=t.data.data.content.list:console.log("区域选择门店")})},handlechange5:function(e){console.log("val",e.row.region);var t=e.row.region[e.row.region.length-1];console.log(t),e.row.regionId=t},findtreedata:function(e,t){var r=this,s=void 0;return(e||[]).map(function(e){if(e.id===t)s=e;else{var n=r.findtreedata(e.subjectFinanceVos,t);n&&(s=n)}}),s},gettree:function(){var e=this;console.log(123),Object(i.g)().then(function(t){if(200===t.data.ret){var r=t.data.data.content;e.switchtreedata(r);e.suboptions=e.processchildren(r),e.treedata=t.data.data.content}}),console.log(321)},processchildren:function(e){for(var t in e)0===e[t].subjectFinanceVos.length?delete e[t].subjectFinanceVos:this.processchildren(e[t].subjectFinanceVos);return e},test:function(e,t){console.log("val",t);var r=t[t.length-1],s=this.findtreedata(this.treedata,r);console.log("needata",s),e.subjectName=s.subjectName,e.subjectCode=s.subjectNumber},getarrs:function(){var e=this.$store.getters.regionId,t=this.findPathByLeafId(e,this.regions);this.personalForm.transferRegion=t,this.personalForm.transferRegionId=e,this.transferRepositoryId=this.$store.getters.repositoryName,this.personalForm.transferRepositoryId=this.$store.getters.repositoryId},findPathByLeafId:function(e,t,r){void 0===r&&(r=[]);for(var s=0;s<t.length;s++){var n=r.concat();if(n.push(t[s].id),e===t[s].id)return n;if(t[s].regionListVos){var o=this.findPathByLeafId(e,t[s].regionListVos,n);if(o)return o}}},tranKTree:function(e){var t=this;if(e&&e.length)return e.map(function(e){return{id:e.id,regionName:e.regionName,regionListVos:t.tranKTree(e.regionListVos)}})},insertEvent:function(e){if(0!==this.$store.getters.repositoryId&&null!==this.$store.getters.repositoryId&&void 0!==this.$store.getters.repositoryId&&""!==this.$store.getters.repositoryId){console.log("this.$store.getters.regionId",this.$store.getters.regionId);var t=this.findPathByLeafId(this.$store.getters.regionId,this.regions);if(console.log("needata",t),t.includes(28)){this.$refs.editable.insertAt({repositoryId:this.$store.getters.repositoryId,subjectFinance:[1,2,9,43,283]},e)}else if(t.includes(29)){this.$refs.editable.insertAt({repositoryId:this.$store.getters.repositoryId,subjectFinance:[1,2,9,43,279]},e)}else if(t.includes(47)){this.$refs.editable.insertAt({repositoryId:this.$store.getters.repositoryId,subjectFinance:[1,2,9,43,231]},e)}else if(t.includes(65)){this.$refs.editable.insertAt({repositoryId:this.$store.getters.repositoryId,subjectFinance:[1,2,9,43,280]},e)}else if(t.includes(66)){this.$refs.editable.insertAt({repositoryId:this.$store.getters.repositoryId,subjectFinance:[1,2,9,43,282]},e)}else if(t.includes(67)){this.$refs.editable.insertAt({repositoryId:this.$store.getters.repositoryId,subjectFinance:[1,2,9,43,285]},e)}else if(t.includes(68)){this.$refs.editable.insertAt({repositoryId:this.$store.getters.repositoryId,subjectFinance:[1,2,9,43,286]},e)}else if(t.includes(79)){this.$refs.editable.insertAt({repositoryId:this.$store.getters.repositoryId,subjectFinance:[1,2,9,43,284]},e)}else if(t.includes(80)){this.$refs.editable.insertAt({repositoryId:this.$store.getters.repositoryId,subjectFinance:[1,2,9,43,281]},e)}else if(t.includes(81)){this.$refs.editable.insertAt({repositoryId:this.$store.getters.repositoryId,subjectFinance:[1,2,9,43,287]},e)}else if(t.includes(90)){this.$refs.editable.insertAt({repositoryId:this.$store.getters.repositoryId,subjectFinance:[1,2,9,43,236]},e)}else this.$refs.editable.insertAt({repositoryId:this.$store.getters.repositoryId},e)}else{var r=this.findPathByLeafId(this.$store.getters.regionId,this.regions);if(console.log("needata",r),r.includes(28)){this.$refs.editable.insertAt({subjectFinance:[1,2,9,43,283]},e)}else if(r.includes(29)){this.$refs.editable.insertAt({subjectFinance:[1,2,9,43,279]},e)}else if(r.includes(47)){this.$refs.editable.insertAt({subjectFinance:[1,2,9,43,231]},e)}else if(r.includes(65)){this.$refs.editable.insertAt({subjectFinance:[1,2,9,43,280]},e)}else if(r.includes(66)){this.$refs.editable.insertAt({subjectFinance:[1,2,9,43,282]},e)}else if(r.includes(67)){this.$refs.editable.insertAt({subjectFinance:[1,2,9,43,285]},e)}else if(r.includes(68)){this.$refs.editable.insertAt({subjectFinance:[1,2,9,43,286]},e)}else if(r.includes(79)){this.$refs.editable.insertAt({subjectFinance:[1,2,9,43,284]},e)}else if(r.includes(80)){this.$refs.editable.insertAt({subjectFinance:[1,2,9,43,281]},e)}else if(r.includes(81)){this.$refs.editable.insertAt({subjectFinance:[1,2,9,43,287]},e)}else if(r.includes(90)){this.$refs.editable.insertAt({subjectFinance:[1,2,9,43,236]},e)}else this.$refs.editable.insertAt({},e)}},getTypes:function(){var e=this;Object(c.p)().then(function(t){200===t.data.ret&&(e.depts=t.data.data.content)}),Object(l.c)(this.colseTypeparms).then(function(t){200===t.data.ret&&(e.colseTypes=t.data.data.content.list)}),Object(d.E)().then(function(t){200===t.data.ret?(e.regions=e.tranKTree(t.data.data.content),e.needreglist=t.data.data.content):console.log("区域列表出错")})},getdatatime:function(){var e=new Date,t=e.getFullYear(),r=e.getMonth()+1,s=e.getDate();r>=1&&r<=9&&(r="0"+r),s>=0&&s<=9&&(s="0"+s);var n=t+"-"+r+"-"+s;this.personalForm.transferDate=n},handlechooseRep:function(){if(null===this.region||""===this.region||void 0===this.region)return this.$notify.error({title:"wrong",message:"请先选择区域",offset:100}),!1;this.repositorycontrol=!0},repositoryname:function(e){this.transferRepositoryId=e.repositoryName,this.personalForm.transferRepositoryId=e.id},change:function(){this.$forceUpdate()},handlechooseStock:function(){this.stockControl=!0},stockName:function(e){console.log(e),this.personalForm.deptId=e.deptId,this.transferRepositoryId=e.repositoryName,this.personalForm.transferRepositoryId=e.repositoryId,this.handlePersonId=e.personName,this.personalForm.handlePersonId=e.id},restAllForm:function(){this.personalForm={createPersonId:this.$store.getters.userId,handlePersonId:this.$store.getters.userId,countryId:this.$store.getters.countryId,repositoryId:this.$store.getters.repositoryId,regionId:this.$store.getters.regionId,currency:"1",direction:"1",transferType:"1"},this.handlePersonId=this.$store.getters.name,this.personalForm.handlePersonId=null,this.incomeRepositoryId=null,this.personalForm.incomeRepositoryId=null},handlesave:function(){var e=this,t=this.personalForm;for(var r in t)""!==t[r]&&void 0!==t[r]&&null!==t[r]||delete t[r];var s=n()(t),o=this.$refs.editable.getRecords();for(var i in o)o[i].subjectCode=o[i].subjectFinance[o[i].subjectFinance.length-1];if(console.log("EnterDetail",o),0===o.length)return this.$notify.error({title:"wrong",message:this.$t("prompt.mxbbnwk"),offset:100}),!1;var l=1;return o.map(function(e){return e}).forEach(function(e){return null!==e.subjectCode&&void 0!==e.subjectCode&&""!==e.subjectCode||(l=4),null!==e.regionId&&void 0!==e.regionId&&""!==e.regionId||null!==e.repositoryId&&void 0!==e.repositoryId&&""!==e.repositoryId||(l=2),null!==e.regionId&&void 0!==e.regionId&&""!==e.regionId&&0!==e.regionId.length&&null!==e.repositoryId&&void 0!==e.repositoryId&&""!==e.repositoryId&&(l=3),null!==e.repositoryId&&""!==e.repositoryId&&void 0!==e.repositoryId||delete e.repositoryId,null!==e.summary&&""!==e.summary&&void 0!==e.summary||delete e.summary,null!==e.subjectFinanceId&&""!==e.subjectFinanceId&&void 0!==e.subjectFinanceId||delete e.subjectFinanceId,null!==e.money&&""!==e.money&&void 0!==e.money||delete e.money,e}),4===l?(this.$notify.error({title:"wrong",message:"会计科目必须选择一个",offset:100}),!1):2===l?(this.$notify.error({title:"wrong",message:"区域，门店必须选择一个",offset:100}),!1):3===l?(this.$notify.error({title:"wrong",message:"区域，门店不能同时选择",offset:100}),!1):void this.$refs.personalForm.validate(function(t){if(!t)return e.$notify.error({title:"wrong",message:"Information is incomplete",offset:100}),!1;o.map(function(e){return e}).forEach(function(e){if(console.log("elem.regionId",e.regionId),null===e.regionId||""===e.regionId||void 0===e.regionId)delete e.regionId;else{var t=e.regionId[e.regionId.length-1];console.log(t),e.regionId=t}});var r=n()(o);Object(a.b)(s,e.personalForm,r).then(function(t){console.log(t),200===t.data.ret?(e.$notify({title:"successful",message:"save successful",type:"success",offset:100}),e.$refs.editable.clear(),e.restAllForm(),e.$refs.personalForm.clearValidate(),e.$refs.personalForm.resetFields()):e.$notify.error({title:"wrong",message:t.data.msg,offset:100})})})},handlecancel:function(){this.$router.go(-1);this.$store.dispatch("delView",{path:"/Transfer/AddTransfer",name:"AddTransfer",fullPath:"/Transfer/AddTransfer",title:"AddTransfer"}).then(function(e){e.visitedViews})}}},f=(r("KsGA"),r("KHd+")),h=Object(f.a)(p,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"ERP-container"},[r("div",{staticClass:"app-container",staticStyle:{"padding-right":"0"}},[r("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[r("h2",{ref:"geren",staticClass:"form-name"},[e._v(e._s(e.$t("Hmodule.basicinfo")))]),e._v(" "),r("div",{staticClass:"container",staticStyle:{"margin-top":"37px"}},[r("el-form",{ref:"personalForm",staticClass:"demo-ruleForm",attrs:{model:e.personalForm,rules:e.personalrules,inline:!0,"status-icon":"","label-width":"130px"}},[r("el-row",[r("el-col",{attrs:{span:6}},[r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("collectAndPayDetail.fx")}},[r("el-select",{staticStyle:{"margin-left":"18px",width:"200px"},model:{value:e.personalForm.direction,callback:function(t){e.$set(e.personalForm,"direction",t)},expression:"personalForm.direction"}},[r("el-option",{attrs:{value:"1",label:"门店"}}),e._v(" "),r("el-option",{attrs:{value:"2",label:"公司"}})],1)],1)],1),e._v(" "),r("el-col",{attrs:{span:6}},[r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("Transfer.title")}},[r("el-input",{staticStyle:{"margin-left":"18px",width:"200px"},attrs:{clearable:""},model:{value:e.personalForm.title,callback:function(t){e.$set(e.personalForm,"title",t)},expression:"personalForm.title"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:6}},[r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("Transfer.transferTicket"),prop:"transferTicket"}},[r("el-input",{staticStyle:{"margin-left":"18px",width:"200px"},attrs:{clearable:""},model:{value:e.personalForm.transferTicket,callback:function(t){e.$set(e.personalForm,"transferTicket",t)},expression:"personalForm.transferTicket"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:6}},[r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("Transfer.transferDate"),prop:"transferDate"}},[r("el-date-picker",{staticStyle:{"margin-left":"18px",width:"200px"},attrs:{"picker-options":e.pickerOptions1,type:"date","value-format":"yyyy-MM-dd"},model:{value:e.personalForm.transferDate,callback:function(t){e.$set(e.personalForm,"transferDate",t)},expression:"personalForm.transferDate"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:6}},[r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("otherlanguage.zzlx")}},[r("el-select",{staticStyle:{"margin-left":"18px",width:"200px"},model:{value:e.personalForm.transferType,callback:function(t){e.$set(e.personalForm,"transferType",t)},expression:"personalForm.transferType"}},[r("el-option",{attrs:{value:"1",label:"现金"}}),e._v(" "),r("el-option",{attrs:{value:"2",label:"支票"}}),e._v(" "),r("el-option",{attrs:{value:"3",label:"银行转账"}})],1)],1)],1),e._v(" "),"2"===e.personalForm.direction?r("el-col",{attrs:{span:6}},["2"===e.personalForm.direction?r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("Transfer.transferInAccount"),prop:"transferInAccount"}},[r("el-select",{staticStyle:{"margin-left":"18px",width:"200px"},on:{focus:e.getaccounts,change:e.setbank},model:{value:e.personalForm.transferInAccount,callback:function(t){e.$set(e.personalForm,"transferInAccount",t)},expression:"personalForm.transferInAccount"}},e._l(e.accounts,function(e,t){return r("el-option",{key:t,attrs:{label:e.accountNumber,value:e.accountNumber}})}))],1):e._e()],1):e._e(),e._v(" "),r("el-col",{directives:[{name:"show",rawName:"v-show",value:"2"===e.personalForm.direction,expression:"personalForm.direction === '2'"}],attrs:{span:6}},[r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("Transfer.transferInBank"),prop:"transferTicket"}},[r("el-input",{staticStyle:{"margin-left":"18px",width:"200px"},attrs:{clearable:"",disabled:""},model:{value:e.personalForm.transferInBank,callback:function(t){e.$set(e.personalForm,"transferInBank",t)},expression:"personalForm.transferInBank"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:6}},[r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("Transfer.handlePersonId"),prop:"handlePersonId"}},[r("el-input",{staticStyle:{"margin-left":"18px",width:"200px"},on:{focus:e.handlechooseStock},model:{value:e.handlePersonId,callback:function(t){e.handlePersonId=t},expression:"handlePersonId"}}),e._v(" "),r("my-emp",{attrs:{control:e.stockControl},on:{"update:control":function(t){e.stockControl=t},stockName:e.stockName}})],1)],1),e._v(" "),r("el-col",{attrs:{span:6}},[r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("Transfer.currency")}},[r("el-select",{staticStyle:{"margin-left":"18px",width:"200px"},model:{value:e.personalForm.currency,callback:function(t){e.$set(e.personalForm,"currency",t)},expression:"personalForm.currency"}},[r("el-option",{attrs:{value:"1",label:"PHP"}}),e._v(" "),r("el-option",{attrs:{value:"2",label:"USD"}}),e._v(" "),r("el-option",{attrs:{value:"3",label:"RMB"}})],1)],1)],1)],1)],1)],1)]),e._v(" "),r("el-card",{staticClass:"box-card",staticStyle:{"margin-top":"15px"},attrs:{shadow:"never"}},[r("h2",{ref:"fuzhu",staticClass:"form-name"},[e._v(e._s(e.$t("otherlanguage.zzmx")))]),e._v(" "),r("div",{staticClass:"buttons",staticStyle:{"margin-top":"35px","margin-bottom":"10px"}},[r("el-button",{on:{click:function(t){e.insertEvent(-1)}}},[e._v(e._s(e.$t("updates.tjsrx")))]),e._v(" "),r("el-button",{attrs:{type:"danger"},on:{click:function(t){e.$refs.editable.removeSelecteds()}}},[e._v(e._s(e.$t("Hmodule.delete")))])],1),e._v(" "),r("div",{staticClass:"container"},[r("el-editable",{ref:"editable",staticClass:"click-table1",staticStyle:{width:"100%"},attrs:{data:e.list2,"edit-config":{showIcon:!0,showStatus:!0},"edit-rules":e.validRules,stripe:"",border:"",size:"medium"},on:{"update:data":function(t){e.list2=t}}},[r("el-editable-column",{attrs:{type:"selection","min-width":"55",align:"center"}}),e._v(" "),r("el-editable-column",{attrs:{label:e.$t("Hmodule.xh"),"min-width":"55",align:"center",type:"index"}}),e._v(" "),r("el-editable-column",{attrs:{"edit-render":{name:"ElCascader ",type:"visible",options:"options"},label:e.$t("Voucher.qy"),prop:"setcarst",align:"center","min-width":"150px"},scopedSlots:e._u([{key:"edit",fn:function(t){return[r("el-cascader",{staticStyle:{"min-width":"180px"},attrs:{options:e.regions,props:e.props,"show-all-levels":!1,placeholder:e.$t("Hmodule.xzqy"),"change-on-select":"",filterable:"",clearable:""},on:{change:e.handlechange4},model:{value:t.row.regionId,callback:function(r){e.$set(t.row,"regionId",r)},expression:"scope.row.regionId"}})]}}])}),e._v(" "),r("el-editable-column",{attrs:{"edit-render":{name:"ElCascader ",type:"visible",options:"options"},label:e.$t("Voucher.md"),prop:"setcarst",align:"center","min-width":"150px"},scopedSlots:e._u([{key:"edit",fn:function(t){return[r("el-select",{staticStyle:{"min-width":"180px"},attrs:{placeholder:e.$t("Hmodule.xzmd"),clearable:"",filterable:""},model:{value:t.row.repositoryId,callback:function(r){e.$set(t.row,"repositoryId",r)},expression:"scope.row.repositoryId"}},e._l(e.repositories,function(e,t){return r("el-option",{key:t,attrs:{label:e.repositoryName,value:e.id}})}))]}}])}),e._v(" "),r("el-editable-column",{attrs:{"edit-render":{name:"ElInput",type:"visible"},label:e.$t("updates.zya"),prop:"summary",align:"center","min-width":"150px"}}),e._v(" "),r("el-editable-column",{attrs:{"edit-render":{name:"ElCascader",type:"visible"},label:e.$t("updates.kmmc"),prop:"subjectFinance",align:"center","min-width":"150px"},scopedSlots:e._u([{key:"edit",fn:function(t){return[r("el-cascader",{attrs:{options:e.suboptions,props:e.props2,"show-all-levels":!1,filterable:""},on:{change:function(r){e.test(t.row,r)}},model:{value:t.row.subjectFinance,callback:function(r){e.$set(t.row,"subjectFinance",r)},expression:"scope.row.subjectFinance"}})]}}])}),e._v(" "),r("el-editable-column",{attrs:{"edit-render":{name:"ElInputNumber",attrs:{min:0,precision:2},type:"visible"},label:e.$t("Hmodule.je"),prop:"money",align:"center","min-width":"150px"}})],1)],1)]),e._v(" "),r("div",{staticClass:"buttons",staticStyle:{"margin-top":"20px"}},[r("el-button",{directives:[{name:"no-more-click",rawName:"v-no-more-click"}],staticStyle:{background:"#3696fd","border-color":"#3696fd",width:"98px"},attrs:{type:"primary"},on:{click:function(t){e.handlesave()}}},[e._v(e._s(e.$t("Hmodule.baoc")))]),e._v(" "),r("el-button",{attrs:{type:"danger"},on:{click:function(t){e.handlecancel()}}},[e._v(e._s(e.$t("Hmodule.cancel")))])],1)],1)])},[],!1,null,"01647404",null);h.options.__file="AddTransfer.vue";t.default=h.exports},yjmD:function(e,t,r){}}]);