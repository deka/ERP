(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-3a5f"],{"0yIV":function(t,e,a){"use strict";var i=a("nwCa");a.n(i).a},nwCa:function(t,e,a){},vqyS:function(t,e,a){"use strict";a.r(e);var i=a("P2sY"),o=a.n(i),s=a("VG0r"),r={name:"Detaillist",data:function(){return{nodata:!1,newnode:"",newdata2:"",newdata:"",Iscode:"",weishu:"",tishi:!1,edittreeform:{},editVisible:!1,filterText:"",detalist:[],detaillistProps:{children:"productClassfyVos",label:"categoryName"},parentId:"",personalForm:{createId:1,levle:1,parentId:0,isActive:1},personalrules:{name:[{required:!0,message:"请输入分类名称",trigger:"blur"}],code:[{required:!0,message:"请输入编码",trigger:"blur"}],isActive:[{required:!0,message:"请选择应用状态",trigger:"change"}]}}},watch:{filterText:function(t){this.$refs.tree2.filter(t)}},created:function(){this.gettree()},beforeCreate:function(){this},methods:{isshow:function(t){return!t.productClassfyVos||!(t.productClassfyVos.length>0)},zhengze:function(t){if("01"===this.Iscode){!1===/^[A-Z0-9]{1}$/.test(this.personalForm.code)&&(this.personalForm.code="")}else{!1===/^[A-Z0-9]{2}$/.test(this.personalForm.code)&&(this.personalForm.code="")}},nodedelete:function(t,e){var a=this;this.$confirm(this.$t("prompt.scts"),this.$t("prompt.ts"),{confirmButtonText:this.$t("prompt.qd"),cancelButtonText:this.$t("prompt.qx"),type:"warning"}).then(function(){Object(s.j)(t.id).then(function(i){if(200===i.data.ret||100===i.data.ret){a.$notify({title:a.$t("prompt.sccg"),type:"success",offset:100}),console.log("node",e),console.log("data",t);var o=e.parent.data.productClassfyVos,s=o.findIndex(function(e){return e.id===t.id});o.splice(s,1)}else a.$notify.error({title:"wrong",message:"wrong",offset:100})})}).catch(function(){a.$message({type:"info",message:a.$t("prompt.yqxsc")})})},handleOk:function(){var t=this;console.log("this.edittreeform",this.edittreeform),Object(s.B)(this.edittreeform).then(function(e){if(200===e.data.ret){t.$notify({title:"successful",message:"修改成功",type:"success",offset:100}),t.editVisible=!1,console.log("this.newnode",t.newnode);var a=t.newnode.parent.data.productClassfyVos,i=a[a.findIndex(function(e){return e.id===t.newdata2.id})];i.categoryName=t.edittreeform.categoryName,i.isActive=t.edittreeform.isActive}})},edittree:function(t,e){console.log(t),this.editVisible=!0,this.newnode=e,this.newdata2=t,this.edittreeform=o()({},t)},recursion:function(t){return 1===t.level?t.data:this.recursion(t.parent)},handleNodeClick:function(t,e){console.log("data",t),this.nodata=!1;var a=this.recursion(e);if("01"===e.parent.data.code||4===t.level&&"02"===a.code||3===t.level&&"03"===a.code)return this.tishi=!1,this.nodata=!0,!1;this.newdata=t,this.personalForm.parentId=t.id,this.parentId=t.categoryName,this.personalForm.levle=t.level+1,this.Iscode=a.code,console.log("ceshidigui",a),console.log("data",t),console.log("node",e),"01"===a.code?(this.tishi=!0,this.weishu="1位"):(this.tishi=!0,this.weishu="2位")},filterNode:function(t,e,a){if(!t)return!0;var i=[];this.getReturnNode(a,i,t);var o=!1;return i.forEach(function(t){o=o||t}),o},getReturnNode:function(t,e,a){var i=t.data&&t.data.categoryName&&-1!==t.data.categoryName.toUpperCase().indexOf(a.toUpperCase());i&&e.push(i),this.index++,!i&&1!==t.level&&t.parent&&this.getReturnNode(t.parent,e,a)},gettree:function(){var t=this;Object(s.l)().then(function(e){200===e.data.ret&&(t.detalist=e.data.data.content)})},handlesave:function(){var t=this;if(console.log(this.personalForm),0===this.personalForm.parentId||"0"===this.personalForm.parentId||null===this.personalForm.parentId||void 0===this.personalForm.parentId)return this.$notify.error({title:"wrong",message:"请选择父级",offset:100}),!1;this.$refs.personalForm.validate(function(e){if(!e)return t.$notify.error({title:"wrong",message:"Information is incomplete",offset:100}),!1;Object(s.f)(t.personalForm).then(function(e){if(console.log(e),200===e.data.ret){t.$notify({title:"successful",message:"新建成功",type:"success",offset:100}),t.restAllForm(),t.$refs.personalForm.clearValidate(),t.$refs.personalForm.resetFields(),console.log(e.data.data.content);var a=e.data.data.content;t.newdata.productClassfyVos||t.$set(t.newdata,"productClassfyVos",[]),t.newdata.productClassfyVos.push(a)}else t.$notify.error({title:"wrong",message:e.data.msg,offset:100})})})},restAllForm:function(){this.personalForm={createId:1,levle:1,parentId:0},this.parentId=""},handlecancel:function(){this.$router.go(-1);this.$store.dispatch("delView",{path:"/Product/detaillist",name:"detaillist",fullPath:"/Product/detaillist",title:"detaillist"}).then(function(t){t.visitedViews})},handlechoose:function(){this.createcontrol=!0}}},l=(a("0yIV"),a("KHd+")),n=Object(l.a)(r,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ERP-container"},[a("div",{staticClass:"app-container",staticStyle:{"padding-right":"0"}},[a("el-card",{staticClass:"box-card",staticStyle:{float:"left",width:"30%",height:"800px"}},[a("el-input",{staticStyle:{"margin-bottom":"30px"},attrs:{placeholder:"输入关键字进行过滤",clearable:""},model:{value:t.filterText,callback:function(e){t.filterText=e},expression:"filterText"}}),t._v(" "),a("el-scrollbar",{staticClass:"tree"},[a("el-tree",{ref:"tree2",staticClass:"filter-tree",attrs:{data:t.detalist,props:t.detaillistProps,"filter-node-method":t.filterNode},on:{"node-click":t.handleNodeClick},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.node,o=e.data;return a("span",{staticClass:"custom-tree-node"},[a("span",[t._v(t._s(i.label)+"  ("+t._s(o.id)+")")]),t._v(" "),0!==o.parentId?a("span",{staticStyle:{"margin-left":"50px"}},[a("i",{staticClass:"el-icon-edit",on:{click:function(e){t.edittree(o,i)}}}),t._v(" "),t.isshow(o)?a("i",{staticClass:"el-icon-delete",on:{click:function(e){t.nodedelete(o,i)}}}):t._e()]):t._e()])}}])})],1),t._v(" "),a("el-dialog",{staticClass:"normal",attrs:{visible:t.editVisible,title:"修改分类",width:"600px"},on:{"update:visible":function(e){t.editVisible=e}}},[a("el-form",{staticStyle:{width:"400px","margin-left":"50px"},attrs:{model:t.edittreeform,"label-position":"left","label-width":"120px"}},[a("el-form-item",{attrs:{label:t.$t("Product.name"),"label-width":"120px"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"",autocomplete:"off"},model:{value:t.edittreeform.categoryName,callback:function(e){t.$set(t.edittreeform,"categoryName",e)},expression:"edittreeform.categoryName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:t.$t("Product.code"),"label-width":"120px"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"",autocomplete:"off",disabled:""},model:{value:t.edittreeform.code,callback:function(e){t.$set(t.edittreeform,"code",e)},expression:"edittreeform.code"}})],1),t._v(" "),a("el-form-item",{attrs:{label:t.$t("Product.isActive"),"label-width":"120px"}},[a("el-radio-group",{staticStyle:{width:"300px"},model:{value:t.edittreeform.isActive,callback:function(e){t.$set(t.edittreeform,"isActive",e)},expression:"edittreeform.isActive"}},[a("el-radio",{staticStyle:{"margin-left":"25px"},attrs:{label:1}},[t._v("启用")]),t._v(" "),a("el-radio",{attrs:{label:2}},[t._v("禁用")])],1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.editVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleOk}},[t._v("确 定")])],1)],1)],1),t._v(" "),a("el-card",{staticClass:"box-card",staticStyle:{float:"left",width:"65%",height:"800px","margin-left":"15px"}},[a("div",{staticClass:"container"},[a("el-form",{ref:"personalForm",staticClass:"demo-ruleForm",staticStyle:{"margin-left":"30px",width:"100%"},attrs:{model:t.personalForm,rules:t.personalrules,inline:!0,"label-position":"right","status-icon":"","label-width":"200px"}},[a("el-row",[a("el-col",{staticStyle:{"margin-top":"20px"},attrs:{span:24}},[a("el-form-item",{attrs:{label:t.$t("Product.name"),prop:"name"}},[a("el-input",{staticStyle:{"margin-left":"18px",width:"600px"},attrs:{disabled:t.nodata,placeholder:"请输入分类名称",clearable:""},model:{value:t.personalForm.name,callback:function(e){t.$set(t.personalForm,"name",e)},expression:"personalForm.name"}})],1)],1),t._v(" "),a("el-col",{directives:[{name:"show",rawName:"v-show",value:!0===t.tishi,expression:"tishi === true"}],staticStyle:{"margin-top":"20px"},attrs:{span:24}},[!0===t.tishi?a("span",{staticStyle:{float:"left",color:"red","margin-top":"-23px","margin-left":"223px"}},[t._v("请输入"+t._s(t.weishu)+"编码")]):t._e(),t._v(" "),a("el-form-item",{attrs:{label:t.$t("Product.code2"),prop:"code"}},[a("el-input",{staticStyle:{"margin-left":"18px",width:"600px"},attrs:{disabled:t.nodata,placeholder:"编码",clearable:""},on:{blur:t.zhengze},model:{value:t.personalForm.code,callback:function(e){t.$set(t.personalForm,"code",e)},expression:"personalForm.code"}})],1)],1),t._v(" "),a("el-col",{staticStyle:{"margin-top":"20px"},attrs:{span:24}},[a("el-form-item",{attrs:{label:t.$t("Product.parentId")}},[a("el-input",{staticStyle:{"margin-left":"18px",width:"600px"},attrs:{disabled:!0,placeholder:"所属父级",clearable:""},on:{focus:t.handlechoose},model:{value:t.parentId,callback:function(e){t.parentId=e},expression:"parentId"}})],1)],1),t._v(" "),a("el-col",{staticStyle:{"margin-top":"20px"},attrs:{span:24}},[a("el-form-item",{attrs:{label:t.$t("Product.isActive"),prop:"isActive"}},[a("el-radio-group",{staticStyle:{width:"600px"},attrs:{disabled:t.nodata},model:{value:t.personalForm.isActive,callback:function(e){t.$set(t.personalForm,"isActive",e)},expression:"personalForm.isActive"}},[a("el-radio",{staticStyle:{width:"400px","margin-left":"25px"},attrs:{label:1}},[t._v("启用")]),t._v(" "),a("el-radio",{attrs:{label:2}},[t._v("禁用")])],1)],1)],1)],1)],1)],1),t._v(" "),a("div",{staticClass:"buttons",staticStyle:{"margin-top":"20px","text-align":"center"}},[a("el-button",{staticStyle:{background:"#3696fd","border-color":"#3696fd",width:"98px"},attrs:{type:"primary"},on:{click:function(e){t.handlesave()}}},[t._v(t._s(t.$t("updates.create")))]),t._v(" "),a("el-button",{attrs:{type:"danger"},on:{click:function(e){t.handlecancel()}}},[t._v(t._s(t.$t("Hmodule.cancel")))])],1)])],1)])},[],!1,null,"57b09342",null);n.options.__file="detaillist.vue";e.default=n.exports}}]);